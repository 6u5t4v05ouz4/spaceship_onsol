# Story 2.4: Página de Missões

## Status

Draft

---

## Story

**As a** Gamer em Space Crypto Miner,
**I want** visualizar uma lista de missões disponíveis com prêmios,
**so that** eu possa saber quais tarefas completar para ganhar recompensas.

---

## Acceptance Criteria

1. ✅ Usuário clica em "Missões" no menu → acessa página de missões
2. ✅ Página exibe lista de missões disponíveis com: título, descrição, status, prêmio
3. ✅ Cada missão mostra: ✅ Completa / ⏳ Em Progresso / ⬜ Não iniciada
4. ✅ Usuário consegue clicar em uma missão para ver detalhes
5. ✅ Página de detalhes mostra: objetivo, recompensa (coins/exp), status, botão "Jogar"
6. ✅ Botão "Jogar" leva ao jogo para completar a missão
7. ✅ Lista é paginada (10 missões por página) ou com scroll infinito
8. ✅ Há filtro: Todas, Completas, Em Progresso, Não Iniciadas
9. ✅ Layout segue UI_UX_DESIGN_SYSTEM.md
10. ✅ Interface é responsiva
11. ✅ Usuário consegue voltar ao dashboard

---

## User Flow

```
Dashboard
    │
    ▼
User clica "Missões" no menu
    │
    ▼
┌─────────────────────────────────────┐
│      MISSIONS PAGE                  │
│                                     │
│ Filtros: [Todas] [Completas] ...    │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │ ✅ Derrotar 10 Inimigos          │ │
│ │ Prêmio: 500 coins + 100 exp      │ │
│ │ Status: Completa                 │ │
│ │ [Ver Detalhes]                   │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │ ⏳ Coletar 50 Cristais            │ │
│ │ Prêmio: 1000 coins               │ │
│ │ Status: Em Progresso (40/50)    │ │
│ │ [Ver Detalhes]                   │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │ ⬜ Encontrar o Tesouro Perdido    │ │
│ │ Prêmio: 2000 coins + 500 exp     │ │
│ │ Status: Não Iniciada             │ │
│ │ [Ver Detalhes] [Jogar]           │ │
│ └─────────────────────────────────┘ │
│                                     │
│ [← Voltar ao Dashboard]             │
└─────────────────────────────────────┘
    │
    ▼
User clica em "Ver Detalhes" de uma missão
    │
    ▼
┌─────────────────────────────────────┐
│     MISSION DETAILS                 │
│                                     │
│ 🎯 Encontrar o Tesouro Perdido      │
│                                     │
│ Descrição:                          │
│ "Explore a caverna escura e        │
│  encontre o tesouro misterioso"     │
│                                     │
│ Objetivo: Encontrar 1 Tesouro      │
│ Prêmio: 2000 coins + 500 exp       │
│ Dificuldade: Médio                 │
│ Status: Não Iniciada                │
│                                     │
│ [← Voltar] [Jogar Agora!]           │
└─────────────────────────────────────┘
```

---

## Dev Notes

### Missions Schema

**Tabela em Supabase (missions):**
```sql
missions:
  - id (UUID, PK)
  - title (string)
  - description (text)
  - objective (string)
  - reward_coins (integer)
  - reward_exp (integer)
  - difficulty ('easy', 'medium', 'hard')
  - created_at (timestamp)

user_mission_progress:
  - id (UUID, PK)
  - user_id (FK to auth.users)
  - mission_id (FK to missions)
  - status ('not_started', 'in_progress', 'completed')
  - progress (integer, %)
  - completed_at (timestamp, nullable)
  - created_at (timestamp)
```

### Missions Service

**Localização:** `src/shared/services/missionsService.js`

```javascript
export async function getMissions(supabase, filter = 'all')
export async function getMissionDetails(supabase, missionId)
export async function getUserMissionProgress(supabase, userId, missionId)
export async function completeMission(supabase, userId, missionId)
```

### MissionsPage Component

**Localização:** `src/web/pages/MissionsPage.js`

**Estados:**
- Lista de missões
- Filtro selecionado
- Página atual (se paginado)
- Missão selecionada (para detalhes)

---

## Tasks / Subtasks

- [ ] **Task 1: Criar Schema Missions** (AC: 1)
  - [ ] Criar tabelas: missions, user_mission_progress
  - [ ] Seed dados de teste
  - [ ] RLS policies

- [ ] **Task 2: Criar MissionsService** (AC: 2, 3)
  - [ ] Criar `src/shared/services/missionsService.js`
  - [ ] Métodos para buscar missões, filtrar, etc

- [ ] **Task 3: Criar MissionsPage** (AC: 2, 4, 7, 8, 9, 10)
  - [ ] Criar `src/web/pages/MissionsPage.js`
  - [ ] Renderizar lista de missões
  - [ ] Implementar filtros
  - [ ] Paginação ou scroll infinito
  - [ ] Card de missão com detalhes

- [ ] **Task 4: Criar MissionDetailsPage** (AC: 5, 6)
  - [ ] Criar `src/web/pages/MissionDetailsPage.js`
  - [ ] Exibir detalhes completos
  - [ ] Botão "Jogar" → leva ao jogo

- [ ] **Task 5: Testar Fluxo** (AC: todos)
  - [ ] Login → Dashboard → Missões
  - [ ] Ver lista com filtros
  - [ ] Clicar em missão
  - [ ] Ver detalhes
  - [ ] Jogar

- [ ] **Task 6: E2E Tests** (AC: todas)
  - [ ] Criar `tests/e2e/missions.spec.js`

---

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-10-18 | 1.0 | Initial user story created by Scrum Master | Bob (SM) |
