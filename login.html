<!doctype html>
<html lang="pt-BR">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Space Crypto Miner - Login</title>
    <link rel="icon" href="/assets/icones/icone.png" />
    
    <!-- Novo Sistema CSS Modular -->
    <link rel="stylesheet" href="/src/styles/main.css">
    
    <!-- Supabase SDK -->
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    
    <!-- Phaser.js para simula√ß√£o -->
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.70.0/dist/phaser.min.js"></script>
    
    <style>
        /* CSS espec√≠fico da p√°gina de login */
        .login-container {
            position: relative;
            width: 100%;
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: var(--z-content);
            text-align: center;
            padding: var(--spacing-xl);
        }
        
        .login-card {
            background: var(--primary-cyan-dark);
            border: 2px solid var(--primary-cyan-light);
            border-radius: var(--border-radius-xl);
            padding: var(--spacing-xxl);
            max-width: 500px;
            width: 100%;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            animation: fadeInUp 1s ease-out;
        }
        
        .login-card:hover {
            border-color: var(--primary-cyan);
            box-shadow: 0 0 30px rgba(0, 255, 204, 0.4);
            transform: translateY(-8px);
        }
        
        .login-title {
            font-family: var(--font-primary);
            font-size: var(--text-xl);
            color: var(--primary-cyan);
            text-shadow: var(--text-glow-secondary);
            letter-spacing: var(--letter-spacing-md);
            text-transform: uppercase;
            margin-bottom: var(--spacing-md);
        }
        
        .login-subtitle {
            font-family: var(--font-secondary);
            font-size: var(--text-body-lg);
            color: var(--text-secondary);
            margin-bottom: var(--spacing-xl);
            opacity: 0.8;
        }
        
        .login-options {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-md);
            margin-bottom: var(--spacing-lg);
        }
        
        .login-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--spacing-sm);
            padding: var(--spacing-md) var(--spacing-lg);
            border: none;
            border-radius: var(--border-radius-md);
            font-size: var(--text-body-lg);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition-normal);
            position: relative;
            overflow: hidden;
        }
        
        .login-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.5s ease;
        }
        
        .login-btn:hover::before {
            left: 100%;
        }
        
        .google-btn {
            background: linear-gradient(135deg, #4285f4, #34a853);
            color: white;
        }
        
        .google-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(66, 133, 244, 0.3);
        }
        
        .solana-btn {
            background: linear-gradient(135deg, #9945ff, #14f195);
            color: white;
        }
        
        .solana-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(153, 69, 255, 0.3);
        }
        
        .btn-icon {
            font-size: var(--text-lg);
        }
        
        .login-footer {
            text-align: center;
        }
        
        .login-footer p {
            color: var(--text-secondary);
            font-size: var(--text-body);
            margin: 0;
        }
        
        .back-link {
            position: absolute;
            top: var(--spacing-lg);
            left: var(--spacing-lg);
            color: var(--text-secondary);
            text-decoration: none;
            font-family: var(--font-secondary);
            font-size: var(--text-body);
            transition: var(--transition-normal);
            display: flex;
            align-items: center;
            gap: var(--spacing-xs);
        }
        
        .back-link:hover {
            color: var(--primary-cyan);
            text-shadow: var(--text-glow-secondary);
        }
        
        /* Responsividade */
        @media (max-width: 768px) {
            .login-container {
                padding: var(--spacing-lg);
            }
            
            .login-card {
                padding: var(--spacing-xl);
                margin: var(--spacing-md);
            }
            
            .login-title {
                font-size: var(--text-lg);
            }
            
            .login-btn {
                padding: var(--spacing-sm) var(--spacing-md);
                font-size: var(--text-body);
            }
        }
        
        @media (max-width: 480px) {
            .login-container {
                padding: var(--spacing-md);
            }
            
            .login-card {
                padding: var(--spacing-lg);
                margin: var(--spacing-sm);
            }
            
            .back-link {
                top: var(--spacing-md);
                left: var(--spacing-md);
            }
        }
    </style>
</head>
<body>
    <!-- Background System -->
    <div class="background-primary"></div>
    <div class="stars-background"></div>
    <div class="particles-container" id="particles"></div>
    
    <!-- Main Container -->
    <div class="login-container">
        <!-- Back Link -->
        <a href="/" class="back-link">
            ‚Üê Voltar ao In√≠cio
        </a>
        
        <!-- Login Card -->
        <div class="login-card">
            <div class="login-header">
                <h1 class="login-title">üöÄ SPACE CRYPTO MINER</h1>
                <p class="login-subtitle">Fa√ßa login para continuar sua jornada espacial</p>
            </div>
            
            <div class="login-options">
                <button id="loginGoogleBtn" class="login-btn google-btn">
                    <span class="btn-icon">üîç</span>
                    Login com Google
                </button>
                
                <button id="loginSolanaBtn" class="login-btn solana-btn">
                    <span class="btn-icon">üëª</span>
                    Conectar Phantom Wallet
                </button>
            </div>
            
            <div class="login-footer">
                <p>Escolha uma op√ß√£o para come√ßar sua aventura</p>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="/src/supabase-dev.js"></script>
    <script type="module" src="/src/simulation/background-simulation.js"></script>
    <script>
        // Configura√ß√£o do Supabase
        const supabaseConfig = {
            url: "https://cjrbhqlwfjebnjoyfjnc.supabase.co",
            anonKey: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNqcmJocWx3ZmplYm5qb3lmam5jIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk3MDIwNTMsImV4cCI6MjA3NTI3ODA1M30.X4uaKnfrmHYYSkVXz1qWYF0wmy-bkjHgbvonubYUTA4"
        };

        // Inicializar Supabase
        let supabase = null;
        if (window.supabase) {
            try {
                supabase = window.supabase.createClient(supabaseConfig.url, supabaseConfig.anonKey);
                console.log('‚úÖ Supabase inicializado na p√°gina de login');
            } catch (error) {
                console.error('‚ùå Erro ao inicializar Supabase:', error);
            }
        }

        // Criar part√≠culas
        function createParticles() {
            const particlesContainer = document.getElementById('particles');
            if (!particlesContainer) return;

            for (let i = 0; i < 30; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.top = Math.random() * 100 + '%';
                particle.style.width = Math.random() * 2 + 1 + 'px';
                particle.style.height = particle.style.width;
                particle.style.animationDelay = Math.random() * 3 + 's';
                particlesContainer.appendChild(particle);
            }
        }

        // Login com Google
        async function loginWithGoogle() {
            try {
                console.log('üîÑ Iniciando login com Google...');
                
                if (!supabase) {
                    throw new Error('Supabase n√£o inicializado');
                }

                const { data, error } = await supabase.auth.signInWithOAuth({
                    provider: 'google',
                    options: {
                        redirectTo: window.location.origin + '/auth-callback.html'
                    }
                });

                if (error) {
                    throw error;
                }

                console.log('‚úÖ Login Google iniciado:', data);
                
            } catch (error) {
                console.error('‚ùå Erro no login Google:', error);
                alert('Erro no login: ' + error.message);
            }
        }

        // Login com Solana
        async function loginWithSolana() {
            try {
                console.log('üîÑ Iniciando login com Solana...');
                
                if (!window.solana || !window.solana.isPhantom) {
                    alert('Instale a extens√£o Phantom Wallet para continuar');
                    return;
                }

                const response = await window.solana.connect();
                const publicKey = response.publicKey.toString();
                
                console.log('‚úÖ Carteira conectada:', publicKey);
                
                // Redirecionar para o dashboard
                window.location.href = '/dashboard.html';
                
            } catch (error) {
                console.error('‚ùå Erro ao conectar carteira:', error);
                alert('Erro ao conectar carteira: ' + error.message);
            }
        }

        // Verificar autentica√ß√£o existente
        async function checkExistingAuth() {
            if (supabase && supabase.auth) {
                const { data: { session } } = await supabase.auth.getSession();
                if (session) {
                    console.log('‚úÖ Usu√°rio j√° autenticado, redirecionando...');
                    window.location.href = '/dashboard.html';
                }
            }
        }

        // Inicializa√ß√£o
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ P√°gina de login carregada');
            
            // Criar part√≠culas
            createParticles();
            
            // Verificar autentica√ß√£o existente
            checkExistingAuth();
            
            // Event listeners
            document.getElementById('loginGoogleBtn').addEventListener('click', loginWithGoogle);
            document.getElementById('loginSolanaBtn').addEventListener('click', loginWithSolana);
            
            console.log('‚úÖ P√°gina de login inicializada');
        });
    </script>
</body>
</html>
